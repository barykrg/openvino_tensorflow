 resources:
  repositories:
  - repository: openvino_tensorflow
    type: github
    endpoint: openvinotoolkit
    name: openvinotoolkit/openvino_tensorflow
    
 pool:
  name: 'Default'
  
 variables:
    WORK_DIR: $(Pipeline.Workspace)/openvino_tensorflow
    BUILD_DIR: $(WORK_DIR)/build
    OV_LOCATION: /opt/intel/openvino_2021.3.394/
    
 steps:
 
   - script: |
      rm -rf $(WORK_DIR) ; mkdir $(WORK_DIR)
      rm -rf $(BUILD_DIR) ; mkdir $(BUILD_DIR)
   
   - checkout: self
     clean: true
     lfs: false
     path: openvino_tensorflow
 
   - script: |
      export OPENVINO_TF_BACKEND=CPU
      echo $(WORK_DIR)
      git submodule init
      git submodule update
      docker build -t openvino_tensorflow/ubuntu18.04_base . -f tools/builds/Docker/docker_files/dockerfile.ubuntu18.04_base
     workingDirectory: $(WORK_DIR) 
     displayName: "Build"
     
   - script: |
      rm -rf *
     displayName: "Cleanup"   
     workingDirectory: $(WORK_DIR)
